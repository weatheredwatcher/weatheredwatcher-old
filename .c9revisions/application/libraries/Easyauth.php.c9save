{"ts":1350312295302,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<?php  \nif (!defined('BASEPATH')) exit('No direct script access allowed');\n\n/**\n * @package     EasyAuth\n * @subpackage  Libraries\n * @category    Authentication\n * @author      Wes Edling (joedesigns.com)\n * @copyright   Copyright (c) 2008, joedesigns.com\n * @link \t\thttp://joedesigns.com/labs/EasyAuth\n*/\n\n/**\n * Notes: Uses md5 for password encryption\n * You might need to adjust the query to suit your database structure\n*/\n\nclass Easyauth {\n\t\n\tvar $connected;\n\tvar $user;\n\t\n\tfunction __construct(){\n\t\t$this->CI =& get_instance();\n\t\t$this->CI->load->library('session');\n\t\t$this->CI->load->helper('url');\n\t\t$this->CI->load->database();\n\t\t$this->set();\n\t\t$this->check();\n\t}\n\t\n\tfunction clean($s){\n\t\treturn $this->CI->db->escape($s);\n\t}\n\t\n\tfunction set(){\n\t\tif(isset($_POST['login']['username'])):\n\t\t\t$_SESSION['login']['username'] = $_POST['login']['username'];\n\t\tendif;\n\t\tif(isset($_POST['login']['password'])):\n\t\t\t$_SESSION['login']['password'] = md5($_POST['login']['password']);\n\t\tendif;\n\t}\n\t\n\tfunction check(){\n\t\t\n\t\t$this->connected = false;\n\t\t\n\t\tif(isset($_SESSION['login']['username']) && isset($_SESSION['login']['password'])):\n\t\t\t$chk = $this->CI->db->query(\"\n\t\t\tselect * \n\t\t\tfrom users \n\t\t\twhere \n\t\t\t\tusername = \".$this->clean($_SESSION['login']['username']).\" and \n\t\t\t\tpassword = \".$this->clean($_SESSION['login']['password']).\"\n\t\t\tlimit 1\n\t\t\t\");\n\t\t\tif($chk->num_rows() == 1):\n\t\t\t\t$this->user = $chk->result();\n\t\t\t\t$this->connected = true;\n\t\t\t\t$this->CI->session->set_userdata('username', $_SESSION['login']['username']);\n\t\t\t\t$this->CI->session->set_userdata('logged_in', true);\n\t\t\t\treturn true;\n\t\t\tendif;\n\t\tendif;\n\t\t\n    \tif(isset($_SESSION['login'])):\n\t\tunset($_SESSION['login']);\n\t\tendif;\n\t\t\n\t\treturn false;\n\t\t\n\t}\n\t\n}\n?>"]],"start1":0,"start2":0,"length1":0,"length2":1736}]],"length":1736}
